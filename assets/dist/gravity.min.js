function snakeCase(str){return str&&str.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(s=>s.toLowerCase()).join("_")}function gfTrack(formId,message){var segmentForms=JSON.parse(sessionStorage.getItem("segmentForms")),formName="gform_"+formId;"SUCCESS"==message?analytics.track("Form Submitted",{form:segmentForms[formName].title}):analytics.track("Form Submission Failed",{form:segmentForms[formName].title,error:message})}function gfIdentify(formId){var formName="gform_"+formId,segmentForms=JSON.parse(sessionStorage.getItem("segmentForms")),data=JSON.parse(sessionStorage.getItem(formName));delete traits;let traits={};for(i=0;i<data.length;i++)if(data[i].type&&""!=data[i].trait){switch(value="",data[i].type){case"checkbox":value=!0;break;default:value=data[i].value}""!=value&&(id=segmentForms[formName].fields[data[i].id]?segmentForms[formName].fields[data[i].id]:data[i].trait,id.indexOf(".")>0?(obj=id.split(".",2),traits[obj[0]]||(traits[obj[0]]={}),traits[obj[0]][obj[1]]=value):"company"==id?(traits.company={},traits.company.name=value):traits[id]=value)}console.log(JSON.stringify(traits)),analytics.identify(traits),gfTrack(formId,"SUCCESS")}jQuery(document).ready((function(){let segmentForms={};void 0===sessionStorage.segmentForms&&sessionStorage.setItem("segmentForms",JSON.stringify(segmentForms)),jQuery(".gform_wrapper").each((function(){var segmentForms=JSON.parse(sessionStorage.getItem("segmentForms")),formId=this.id.split("_").pop(),formName="gform_"+formId,formTitle=jQuery(this).find(".gform_title").html();segmentForms[formName]={title:formTitle,fields:{},legends:{}},nameField=jQuery("#"+formName+" .ginput_container_name").first().attr("id"),segmentForms[formName].fields[nameField+"_3"]="first_name",segmentForms[formName].fields[nameField+"_6"]="last_name",addressField=jQuery(this).find(".ginput_container_address").first().attr("id"),segmentForms[formName].fields[addressField+"_1"]="address.street",segmentForms[formName].fields[addressField+"_2"]="address.street2",segmentForms[formName].fields[addressField+"_3"]="address.city",segmentForms[formName].fields[addressField+"_4"]="address.state",segmentForms[formName].fields[addressField+"_5"]="address.postalCode",segmentForms[formName].fields[addressField+"_6"]="address.country",emailField=jQuery(this).find("input[type=email]").first().attr("id"),segmentForms[formName].fields[emailField]="email",phoneField=jQuery(this).find("input[type=tel]").first().attr("id"),segmentForms[formName].fields[phoneField]="phone",jQuery(this).find("legend").each((function(){fieldsetId=jQuery(this).closest("fieldset").attr("id"),segmentForms[formName].legends[fieldsetId]=jQuery(this).text()})),sessionStorage.setItem("segmentForms",JSON.stringify(segmentForms)),jQuery("#gform_submit_button_"+formId).click((function(){const formId=this.id.split("_").pop(),formName="gform_"+formId,formInfo=JSON.parse(sessionStorage.getItem("segmentForms"));jQuery("#gform_"+formId+"_validation_container").empty();var fields=jQuery("#"+formName+" input, #"+formName+" select, #"+formName+" textarea").serializeArray();for(i=0;i<fields.length;i++)thisField=jQuery("[name='"+fields[i].name+"']"),fields[i].id=jQuery(thisField).attr("id"),void 0!==fields[i].id&&(jQuery(thisField).hasClass("textarea")?fields[i].type="textarea":jQuery(thisField).hasClass("gfield_select")?fields[i].type="select":jQuery(thisField).is("select")?fields[i].type="select":fields[i].type=jQuery(thisField).attr("type"),fieldNum=fields[i].id.split("_")[2],legend=formInfo[formName].legends["field_"+formId+"_"+fieldNum],legend="undefined"==typeof legend?"":legend+" ",fields[i].trait=snakeCase(legend+jQuery("label[for='"+fields[i].id+"']").text()));sessionStorage.setItem(formName,JSON.stringify(fields))}))})),jQuery(document).on("gform_confirmation_loaded",(function(event,formId){gfIdentify(formId)})),jQuery(document).on("gform_post_render",(function(event,form_id,current_page){console.log("#gform_"+form_id+"_validation_container")}))}));